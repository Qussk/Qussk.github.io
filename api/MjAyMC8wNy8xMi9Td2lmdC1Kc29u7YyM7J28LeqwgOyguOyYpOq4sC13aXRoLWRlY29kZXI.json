{"title":"[Swift]Json파일 가져오기(with: decoder)","date":"2020-07-12T02:45:28.000Z","date_formatted":{"ll":"Jul 12, 2020","L":"07/12/2020","MM-DD":"07-12"},"thumbnail":"image/json.png","link":"2020/07/12/Swift-Json파일-가져오기-with-decoder","tags":["Bundle","JSON","Path","Swift"],"categories":["ios"],"updated":"2020-08-20T01:08:23.375Z","content":"<h2 id=\"json란?\">JSON란?<a title=\"#json란?\" href=\"#json란?\"></a></h2>\n<ul>\n<li>name: Value의 형태의 쌍을 이루는 콜렉션 타입(Dictionary)</li>\n<li>XML에 비해 기능이 적고 구조가 단순하여 파싱이 쉽고 빠르다.</li>\n<li>적은 용량으로 저장가능</li>\n<li>사람뿐 아니라, 기계가 분석하고 생성하는 것도 용이</li>\n<li>contents type --&gt; application/json</li>\n<li>기본 인코딩 UTF-8</li>\n</ul>\n<p><a href=\"https://github.com/Qussk/Swift-5/blob/master/JSON.md\" target=\"_blank\">JSON 깊게 이해하기</a></p>\n<h2 id=\"json-실제\">JSON 실제<a title=\"#json-실제\" href=\"#json-실제\"></a></h2>\n<p><img src=\"/image/json1.png\" alt=\"\" class=\"φcx\"></p>\n<p>위의 json 형식 파일을 데이터로 불러오는 경우.</p>\n<h3 id=\"1.구조체-만들기\">1.구조체 만들기<a title=\"#1.구조체-만들기\" href=\"#1.구조체-만들기\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> UIKit</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Cafe</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> title: <span class=\"type\">String</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> description: <span class=\"type\">String</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> location: <span class=\"type\">Location</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> isFavorite: <span class=\"type\">Bool</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Location</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> address: <span class=\"type\">String</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> lat: <span class=\"type\">Double</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> lng: <span class=\"type\">Double</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Key이름과 실제 사용할 Key이름이 다를 경우, CodingKey를 사용(enum:열거형) 하지만, 현재 key값이 동일하므로 Decode만 해줘도 된답.</li>\n</ul>\n<h3 id=\"2.-데이타-불러주기(해당-viewcontroller로-이동)\">2. 데이타 불러주기(해당 ViewController로 이동)<a title=\"#2.-데이타-불러주기(해당-viewcontroller로-이동)\" href=\"#2.-데이타-불러주기(해당-viewcontroller로-이동)\"></a></h3>\n<p><strong>Bundle이용하여 리소스 가져오기</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">Bundle</span>.main.path(forResorce: <span class=\"string\">\"CafeList\"</span>, ofType: <span class=\"string\">\"json\"</span>)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>리소스 : “CafeList”, 데이터 타입 : “json”</li>\n</ul>\n<p><strong>URL이용</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> url = <span class=\"type\">URL</span>(fileURLWithPath: path!)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>새로만든 NSURL객체를 지정된 경로를 가진 파일 URL(let path)로 초기화하고 반환. (파일에서 바로 가져오므로 utf-8이용안함)</li>\n</ul>\n<p><strong>Data try!</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> data = <span class=\"keyword\">try</span>! <span class=\"type\">Data</span>(contentsOf: url)</span><br></pre></td></tr></table></figure>\n<p><strong>구조체 담을 변수선언 (타입: [Cafe], 값:빈배열)</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> cageData : [<span class=\"type\">Cafe</span>] = []</span><br></pre></td></tr></table></figure>\n<h3 id=\"3.json가져오기\">3.JSON가져오기<a title=\"#3.json가져오기\" href=\"#3.json가져오기\"></a></h3>\n<p><strong>JSONDecoder</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\"><span class=\"keyword\">super</span>.viewDidLoad()</span><br><span class=\"line\"></span><br><span class=\"line\">   <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> json = <span class=\"keyword\">try</span>? <span class=\"type\">JSONDecoder</span>().decode([<span class=\"type\">Cafe</span>].<span class=\"keyword\">self</span>, from: data) &#123;</span><br><span class=\"line\">     <span class=\"built_in\">print</span>(json)</span><br><span class=\"line\">     <span class=\"comment\">//제이슨을 배열에 담아주기</span></span><br><span class=\"line\">    cafeData.append(contentsOf: json)</span><br><span class=\"line\">     </span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>data로부터, [Cafe].self(배열) decode하기</li>\n<li>데이터 못 가져온 경우,  do ~cashe 이용하여 print(error)로 애러사항 확인 가능.</li>\n<li>성공했다면 아래와 같은 값이 디버깅에 확인됨<br>\n<img src=\"image/json3.png\" alt=\"\"></li>\n</ul>\n<h3 id=\"4.-데이터-불러오기(셋팅?)\">4. 데이터 불러오기(셋팅?)<a title=\"#4.-데이터-불러오기(셋팅?)\" href=\"#4.-데이터-불러오기(셋팅?)\"></a></h3>\n<p><strong>CollectionViewCell</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">configureCell</span><span class=\"params\">(data: Cafe)</span></span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">let</span> title = data.title</span><br><span class=\"line\">  <span class=\"keyword\">let</span> description = data.description</span><br><span class=\"line\">  </span><br><span class=\"line\">  cafeImageView.image = <span class=\"type\">UIImage</span>(named: title)</span><br><span class=\"line\">  cafeTitle.text = title</span><br><span class=\"line\">  cafeComent.text = description</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>data는 cafe라는 (타입/값)을 가진 Key임</li>\n</ul>\n<p><strong>CollectionViewDataSource</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cell.configureCell(data: cafeData[indexPath.item])</span><br></pre></td></tr></table></figure>\n<ul>\n<li>cellForItemAt에 CollectionViewCell에서 만들어준 configureCell 값 붙이기.</li>\n</ul>\n<h2 id=\"결과\">결과<a title=\"#결과\" href=\"#결과\"></a></h2>\n<p><img src=\"/image/json2.png\" alt=\"\" class=\"φcx\"></p>\n","prev":{"title":"[Swift]UISearchController ?? searchController : searchBar","link":"2020/07/12/Swift-UISearchController"},"next":{"title":"[Swift]UIView에 shadow주기","link":"2020/07/09/Swift-UIView에-shadow주기"},"plink":"https://Qussk.github.io/2020/07/12/Swift-Json파일-가져오기-with-decoder/","toc":[{"id":"json란?","title":"JSON란?","index":"1"},{"id":"json-실제","title":"JSON 실제","index":"2","children":[{"id":"1.구조체-만들기","title":"1.구조체 만들기","index":"2.1"},{"id":"2.-데이타-불러주기(해당-viewcontroller로-이동)","title":"2. 데이타 불러주기(해당 ViewController로 이동)","index":"2.2"},{"id":"3.json가져오기","title":"3.JSON가져오기","index":"2.3"},{"id":"4.-데이터-불러오기(셋팅?)","title":"4. 데이터 불러오기(셋팅?)","index":"2.4"}]},{"id":"결과","title":"결과","index":"3"}]}