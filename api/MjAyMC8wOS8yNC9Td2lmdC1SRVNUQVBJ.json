{"title":"[Swift]RESTAPI - decode","date":"2020-09-24T23:02:49.000Z","date_formatted":{"ll":"Sep 24, 2020","L":"09/24/2020","MM-DD":"09-24"},"link":"2020/09/24/Swift-RESTAPI","tags":["Codable","JSON","RESTAPI","Swift"],"categories":["ios"],"updated":"2020-09-24T14:12:13.428Z","content":"<h2 id=\"model\">Model<a title=\"#model\" href=\"#model\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MenuData</span>: <span class=\"title\">Codable</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">var</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> image: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> caption: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> price: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> optionGroup: [<span class=\"type\">OptionGroup?</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">        id = <span class=\"number\">0</span></span><br><span class=\"line\">        name = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        image = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        caption = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        price = <span class=\"number\">0</span></span><br><span class=\"line\">        optionGroup = [<span class=\"type\">OptionGroup</span>]()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">CodingKeys</span>: <span class=\"title\">String</span>, <span class=\"title\">CodingKey</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> id, name, image, caption, price</span><br><span class=\"line\">        <span class=\"keyword\">case</span> optionGroup = <span class=\"string\">\"option_group\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OptionGroup</span>: <span class=\"title\">Codable</span> </span>&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">var</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> menuId: <span class=\"type\">Int</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">var</span> mandatory: <span class=\"type\">Bool</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> option: [<span class=\"type\">Option</span>]</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">            id = <span class=\"number\">0</span></span><br><span class=\"line\">            name = <span class=\"string\">\"\"</span></span><br><span class=\"line\">            mandatory = <span class=\"literal\">true</span></span><br><span class=\"line\">            menuId = <span class=\"number\">0</span></span><br><span class=\"line\">            option = [<span class=\"type\">Option</span>]()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">CodingKeys</span>: <span class=\"title\">String</span>, <span class=\"title\">CodingKey</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> id, name, mandatory, option</span><br><span class=\"line\">            <span class=\"keyword\">case</span> menuId = <span class=\"string\">\"menu_id\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Option</span>: <span class=\"title\">Codable</span> </span>&#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">var</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> price: <span class=\"type\">Int</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> optionGroupId: <span class=\"type\">Int</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> selectPos: <span class=\"type\">Bool</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">                id = <span class=\"number\">0</span></span><br><span class=\"line\">                name = <span class=\"string\">\"\"</span></span><br><span class=\"line\">                price = <span class=\"number\">0</span></span><br><span class=\"line\">                optionGroupId = <span class=\"number\">0</span></span><br><span class=\"line\">                selectPos = <span class=\"literal\">false</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">CodingKeys</span>: <span class=\"title\">String</span>, <span class=\"title\">CodingKey</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> id, name, price, selectPos</span><br><span class=\"line\">                <span class=\"keyword\">case</span> optionGroupId = <span class=\"string\">\"option_group_id\"</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"변수로-model-가져오기\">변수로 Model 가져오기<a title=\"#변수로-model-가져오기\" href=\"#변수로-model-가져오기\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> usd : <span class=\"type\">MenuData?</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"urlsession---jsondecoder\">URLSession - JSONDecoder<a title=\"#urlsession---jsondecoder\" href=\"#urlsession---jsondecoder\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">fechData</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> url = <span class=\"type\">URL</span>(string: <span class=\"type\">UrlBase</span>.menuInstance)</span><br><span class=\"line\">  <span class=\"type\">URLSession</span>.shared.dataTask(with: url!) &#123; (data, response, error) <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> error == <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">do</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.usd = <span class=\"keyword\">try</span> <span class=\"type\">JSONDecoder</span>().decode(<span class=\"type\">MenuData</span>.<span class=\"keyword\">self</span>, from: data!)</span><br><span class=\"line\">      &#125;<span class=\"keyword\">catch</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"catch\"</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"type\">DispatchQueue</span>.main.async&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"usd?.name : \\(self.usd?.name)\"</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">print</span>(<span class=\"string\">\"Error\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;.resume()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"urlbase\">UrlBase<a title=\"#urlbase\" href=\"#urlbase\"></a></h1>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">UrlBase</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">let</span> menuInstance = <span class=\"string\">\"http://52.79.251.125/menu/\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">(중략)</span><br><span class=\"line\">이런식으로 쭉 있음 </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"id으로-api구분하여-가져오기\">id으로 api구분하여 가져오기<a title=\"#id으로-api구분하여-가져오기\" href=\"#id으로-api구분하여-가져오기\"></a></h1>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">var</span> id : <span class=\"type\">Int</span> = <span class=\"number\">20</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"이런식으로-id값에-따라-가져올-수-있음\">이런식으로 id값에 따라 가져올 수 있음<a title=\"#이런식으로-id값에-따라-가져올-수-있음\" href=\"#이런식으로-id값에-따라-가져올-수-있음\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"UrlBase.menuInstance.\\(String(id))\"</span></span><br><span class=\"line\">\\(<span class=\"type\">String</span>(id))</span><br></pre></td></tr></table></figure>\n","prev":{"title":"[Swift]scrollToRow 최상단 이동","link":"2020/09/24/Swift-최상단-이동"},"next":{"title":"[swift]Alamofire 작업하기","link":"2020/09/15/swift-Alamofire-작업하기"},"plink":"https://Qussk.github.io/2020/09/24/Swift-RESTAPI/","toc":[{"id":"model","title":"Model","index":"1"},{"id":"변수로-model-가져오기","title":"변수로 Model 가져오기","index":"2"},{"id":"urlsession---jsondecoder","title":"URLSession - JSONDecoder","index":"3"}]}