{"title":"[Swift]Contacts - ì—°ë½ì²˜ ì •ë³´ê°€ì ¸ì˜¤ê¸°","date":"2020-08-08T09:52:18.000Z","date_formatted":{"ll":"Aug 8, 2020","L":"08/08/2020","MM-DD":"08-08"},"link":"2020/08/08/Swift-Contacts-á„‹á…§á†«á„…á…¡á†¨á„á…¥-á„Œá…¥á†¼á„‡á…©á„€á…¡á„Œá…§á„‹á…©á„€á…µ","tags":["Contacts","Swift"],"categories":["ios"],"updated":"2020-09-14T08:28:54.000Z","content":"<p>Contactsì„ ì´ìš©í•˜ì—¬, ì•±ìœ¼ë¡œ ì—°ë½ì²˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸°,!</p>\n<p>ë“¤ì–´ê°€ê¸° ì „ì— ì•„ë˜ CNContactì— ëŒ€í•œ ì• í”Œë¬¸ì„œë¥¼ í™•ì¸í•˜ì.</p>\n<p><a href=\"https://developer.apple.com/documentation/contacts/cncontact\" target=\"_blank\">ë§í¬ : https://developer.apple.com/documentation/contacts/cncontact</a></p>\n<p>ë¬¸ì„œë¥¼ ìš”ì•½í•˜ìë©´,</p>\n<p><img src=\"/image/Contact3.png\" alt=\"\" class=\"Ï†cx\"></p>\n<p>ì˜¤ë¥¸ìª½ì˜ ì •ë³´ë“¤ì„ ê°€ì ¸ì˜¨ë‹¤ëŠ” ëœ».</p>\n<p>ë‚˜ëŠ” phoneNumbersì™€</p>\n<p>class func descriptorForAllComparatorKeys() -&gt; CNKeyDescriptor<br>\n(ì—°ë½ì²˜ ì •ë ¬ ë¹„êµê¸°ì— í•„ìš”í•œ ëª¨ë“  í‚¤ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.)ì„ ì´ìš©í•´ fullnameì„ ê°€ì ¸ì™”ë‹¤.</p>\n<p>ìì„¸í•œ ë‚´ìš©ì€<br>\nì•„ë˜ ì½”ë“œì—ì„œ ì£¼ì„ìœ¼ë¡œ ìˆ«ìë¥¼ ë‹¬ì•˜ëŠ”ë°, ì½”ë“œì™€ ë¹„êµí•´ë³´ë©´ì„œ ì½ì–´ë³´ê¸¸ ë°”ë€ë‹¤!</p>\n<h2 id=\"1.-viewcontroller\">1. ViewController<a title=\"#1.-viewcontroller\" href=\"#1.-viewcontroller\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> UIKit</span><br><span class=\"line\"><span class=\"keyword\">import</span> Contacts</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewController</span>: <span class=\"title\">UIViewController</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">let</span> tableView = <span class=\"type\">UITableView</span>(frame: .zero, style: .grouped)</span><br><span class=\"line\">  <span class=\"keyword\">var</span> objects = [<span class=\"type\">CNContact</span>]() <span class=\"comment\">//1-1.</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.viewDidLoad()</span><br><span class=\"line\">    </span><br><span class=\"line\">    tableView.dataSource = <span class=\"keyword\">self</span></span><br><span class=\"line\">    tableView.delegate = <span class=\"keyword\">self</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    tableView.rowHeight = <span class=\"number\">80</span></span><br><span class=\"line\">    tableView.backgroundColor = .white</span><br><span class=\"line\">    view.addSubview(tableView)</span><br><span class=\"line\">    </span><br><span class=\"line\">    tableView.register(testTableViewCell.<span class=\"keyword\">self</span>, forCellReuseIdentifier: <span class=\"string\">\"testTableViewCell\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\">    findContactsOnBackgroundThread &#123; (contacts) <span class=\"keyword\">in</span></span><br><span class=\"line\">      <span class=\"keyword\">self</span>.objects = contacts!</span><br><span class=\"line\">      <span class=\"keyword\">self</span>.tableView.reloadData()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    tableView.translatesAutoresizingMaskIntoConstraints = <span class=\"literal\">false</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"type\">NSLayoutConstraint</span>.activate([</span><br><span class=\"line\">      tableView.topAnchor.constraint(equalTo: view.topAnchor),</span><br><span class=\"line\">      tableView.leadingAnchor.constraint(equalTo: view.leadingAnchor),</span><br><span class=\"line\">      tableView.trailingAnchor.constraint(equalTo: view.trailingAnchor),</span><br><span class=\"line\">      tableView.bottomAnchor.constraint(equalTo: view.bottomAnchor)</span><br><span class=\"line\">    ])</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findContactsOnBackgroundThread</span> <span class=\"params\">(<span class=\"number\">_</span> completionHandler: @escaping <span class=\"params\">(<span class=\"number\">_</span> contacts:[CNContact]?)</span></span></span>-&gt;()) &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"type\">DispatchQueue</span>.global(qos: .background).async(execute: &#123; () -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//1-2.</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> keysToFetch = [<span class=\"type\">CNContactFormatter</span>.descriptorForRequiredKeys(<span class=\"keyword\">for</span>: .fullName), <span class=\"type\">CNContactPhoneNumbersKey</span>] <span class=\"keyword\">as</span> [<span class=\"type\">Any</span>]</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"keyword\">let</span> fetchRequest = <span class=\"type\">CNContactFetchRequest</span>( keysToFetch: keysToFetch <span class=\"keyword\">as</span>! [<span class=\"type\">CNKeyDescriptor</span>])</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">/* This is the array of objects that will be passed into the completion block.</span></span><br><span class=\"line\"><span class=\"comment\">       And then retrieved as the objects array</span></span><br><span class=\"line\"><span class=\"comment\">      objects ë°°ì—´ì´ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•¨.</span></span><br><span class=\"line\"><span class=\"comment\">      */</span></span><br><span class=\"line\">      <span class=\"keyword\">var</span> contacts = [<span class=\"type\">CNContact</span>]()</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//1-3.</span></span><br><span class=\"line\">      <span class=\"type\">CNContact</span>.localizedString(forKey: <span class=\"type\">CNLabelPhoneNumberiPhone</span>)</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"keyword\">if</span> #available(iOS <span class=\"number\">10.0</span>, *) &#123;</span><br><span class=\"line\">        fetchRequest.mutableObjects = <span class=\"literal\">false</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Fallback on earlier versions</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//1-4.</span></span><br><span class=\"line\">      fetchRequest.unifyResults = <span class=\"literal\">true</span></span><br><span class=\"line\">      fetchRequest.sortOrder = .userDefault</span><br><span class=\"line\">      </span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//ì—°ë½ì²˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì—ëŸ¬ë‚¨. ì„±ê³µì„ ìœ„í•´ do/try/catch block í•„ìš”.</span></span><br><span class=\"line\">      <span class=\"comment\">//1-5.</span></span><br><span class=\"line\">     <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// For each CNContact in your phone...</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> <span class=\"type\">CNContactStore</span>().enumerateContacts(with: fetchRequest) &#123; (contact, stop) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">          <span class=\"comment\">//ì—°ë½ì²˜ë¥¼ ì •ë ¬</span></span><br><span class=\"line\">  </span><br><span class=\"line\">          <span class=\"comment\">// If this contact has a phone number, append to the array</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> contact.phoneNumbers.<span class=\"built_in\">count</span> &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">            contacts.append(contact)</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// Catch the error, if it exists</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> e <span class=\"keyword\">as</span> <span class=\"type\">NSError</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(e.localizedDescription)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"type\">DispatchQueue</span>.main.async(execute: &#123; () -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">        <span class=\"comment\">//ì™„ì„±ë˜ë©´ contacts ë°°ì—´ì„ ì œê³µ</span></span><br><span class=\"line\">        completionHandler(contacts)</span><br><span class=\"line\">        </span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//MARK: -UITableViewDataSource</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">ViewController</span>: <span class=\"title\">UITableViewDataSource</span></span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">tableView</span><span class=\"params\">(<span class=\"number\">_</span> tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> objects.<span class=\"built_in\">count</span></span><br><span class=\"line\">    </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">tableView</span><span class=\"params\">(<span class=\"number\">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class=\"type\">UITableViewCell</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> cell = tableView.dequeueReusableCell(withIdentifier: <span class=\"string\">\"testTableViewCell\"</span>, <span class=\"keyword\">for</span>: indexPath) <span class=\"keyword\">as</span>! testTableViewCell</span><br><span class=\"line\"> </span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> contact = <span class=\"keyword\">self</span>.objects[indexPath.row]</span><br><span class=\"line\">    </span><br><span class=\"line\">    configureCell(cell, contact: contact)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cell</span><br><span class=\"line\">    </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">ViewController</span>: <span class=\"title\">UITableViewDelegate</span></span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">tableView</span><span class=\"params\">(<span class=\"number\">_</span> tableView: UITableView, heightForRowAt indexPath: IndexPath)</span></span> -&gt; <span class=\"type\">CGFloat</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">80</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">configureCell</span><span class=\"params\">(<span class=\"number\">_</span> cell: testTableViewCell, contact: CNContact)</span></span> &#123;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"keyword\">let</span> formatter = <span class=\"type\">CNContactFormatter</span>()</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"keyword\">let</span> contactPhoneNumber = (contact.phoneNumbers[<span class=\"number\">0</span>].value).value(forKey: <span class=\"string\">\"digits\"</span>) <span class=\"keyword\">as</span>? <span class=\"type\">String</span></span><br><span class=\"line\">      </span><br><span class=\"line\">      cell.personName.text = formatter.string(from: contact)</span><br><span class=\"line\">      cell.conditionMassge.text = contactPhoneNumber</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ì¼ë‹¨ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë§Œë“ ê±°ë¼â€¦ viewDidLoadê°€ ë¹µë¹µ ã…ã…â€¦</p>\n<ul>\n<li>\n<p>1-1. <strong>objects = <a href=\"\">CNContact</a></strong> ëŠ” CNContact(ì—°ë½ì²˜)ì˜ ë°°ì—´ì„ ë‹´ì€ ê°ì²´</p>\n</li>\n<li>\n<p>1-2. <strong>ì—°ë½ì²˜ë¹„êµ : class func descriptorForAllComparatorKeys() -&gt;. CNKeyDescriptor<br>\n(ì—°ë½ì²˜ ì •ë ¬ ë¹„êµê¸°ì— í•„ìš”í•œ ëª¨ë“  í‚¤ë¥¼ ê°€ì ¸ì˜´.)</strong></p>\n</li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> keysToFetch = [<span class=\"type\">CNContactFormatter</span>.descriptorForRequiredKeys(<span class=\"keyword\">for</span>: .fullName), <span class=\"type\">CNContactPhoneNumbersKey</span>] <span class=\"keyword\">as</span> [<span class=\"type\">Any</span>]</span><br></pre></td></tr></table></figure>\n<p><strong>keysToFetch</strong>ëŠ” CNContactFormatterì˜ descriptorForRequiredKeysë¡œ ì ‘ê·¼í•˜ì—¬, <strong>.fullName</strong>ì„ ê°€ì ¸ì˜¤ê³  CNContactPhoneNumbersKeyì—ë„ ì ‘ê·¼í•˜ë„ë¡ í•˜ëŠ” ê·¸ë¦‡ì´ë‹¤.</p>\n<p>ì´ ê·¸ë¦‡ì„</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">   <span class=\"keyword\">let</span> fetchRequest = <span class=\"type\">CNContactFetchRequest</span>( keysToFetch: keysToFetch <span class=\"keyword\">as</span>! [<span class=\"type\">CNKeyDescriptor</span>])</span><br><span class=\"line\">```   </span><br><span class=\"line\">fetchRequestì—</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">CNContactFetchRequest</span>(ì—°ë½ì²˜ë¥¼ ì¼ì¹˜ì‹œí‚¤ê¸°ìœ„í•œ ìˆ ì–´) ì— <span class=\"type\">CNKeyDescriptor</span>ì˜ ë°°ì—´ì„ ì—…ìºìŠ¤íŒ…í•˜ì—¬ <span class=\"type\">CNKeyDescriptor</span>ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">CNKeyDescriptor</span>ì— ëŒ€í•œ ì •ë³´ëŠ” í€µí—¬í¼ë¡œ í™•ì¸ê°€ëŠ¥. </span><br><span class=\"line\"></span><br><span class=\"line\">![](/image/<span class=\"type\">Contact4</span>.png) </span><br><span class=\"line\"></span><br><span class=\"line\">ì´ë ‡ê²Œ ë˜ì–´ìˆì—ˆë‹¤ ! ...</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- <span class=\"number\">1</span>-<span class=\"number\">3</span>. **ì—°ë½ì²˜ ë°ì´í„° í˜„ì§€í™” : </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">func</span> <span class=\"title\">localizedString</span>(<span class=\"title\">forKey</span>: <span class=\"title\">String</span>) -&gt; <span class=\"title\">String</span></span></span><br><span class=\"line\"><span class=\"class\">ì§€ì—­í™” ëœ ì—°ë½ì²˜ ì†ì„± ì´ë¦„ì´ í¬í•¨ ëœ ë¬¸ìì—´ì„ ë°˜í™˜.** </span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\">```<span class=\"title\">swift</span></span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">CNContact</span>.<span class=\"title\">localizedString</span>(<span class=\"title\">forKey</span>: <span class=\"title\">CNLabelPhoneNumberiPhone</span>)</span></span><br><span class=\"line\"><span class=\"class\">   </span></span><br><span class=\"line\"><span class=\"class\">   <span class=\"title\">if</span> #<span class=\"title\">available</span>(<span class=\"title\">iOS</span> 10.0, *) </span>&#123;</span><br><span class=\"line\">     fetchRequest.mutableObjects = <span class=\"literal\">false</span></span><br><span class=\"line\">   &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">     <span class=\"comment\">// Fallback on earlier versions</span></span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n<p>localizedStringì€ ë¬¸ìì—´ì„ ë°˜í™˜í•˜ëŠ” ìš©ë„, ê·¸ì¤‘ CNLabelPhoneNumberiPhone í•¸ë“œí° ë²ˆí˜¸ë¥¼ ê°€ì ¸ì™€ ë°˜í™˜ì‹œí‚¨ë‹¤.</p>\n<p>ë§Œì•½ iOS10ì´í•˜ë©´,<br>\nfetchRequest.mutableObjects = faleseë¡œ<br>\nstringì˜ ê°’ ë®¤í„°ë¸”(ë³€ìˆ˜) ë³€ê²½ë¶ˆê°€ëŠ¥í•˜ê²Œ ì²˜ë¦¬</p>\n<p>ì´ì „ ë²„ì „ì˜ í°ì´ ì™”ì„ ë•Œì˜ ëŒ€ë¹„ì±…ì¸ê±° ê°™ë‹¤. ê·¸ëŸ°ë° ì´ë¯¸ í”„ë¡œì íŠ¸ë¥¼ 13ì´ìƒì—ì„œë§Œ ë‹¤ìš´í• ìˆ˜ ìˆë„ë¡ í•´ë†”ì„œâ€¦ ã…ã… ì•ˆì¨ë„ë ë“¯í•˜ì§€ë§Œâ€¦ ê³µë¶€í•´ë³¼ê²¸ ,!!</p>\n<p>1-4.</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//1-4.</span></span><br><span class=\"line\"> fetchRequest.unifyResults = <span class=\"literal\">true</span></span><br><span class=\"line\"> fetchRequest.sortOrder = .userDefault</span><br></pre></td></tr></table></figure>\n<p><strong>unifyResults</strong>í˜„ì¬ ì—°ë½ì²˜ê°€ í†µí•© ì—°ë½ì²˜ì´ê³  ì§€ì •ëœ ì‹ë³„ìë¥¼ ê°€ì§„ ì—°ë½ì²˜ë¥¼ í¬í•¨í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Boolê°’. <strong>sortOrder</strong> ì—°ë½ì²˜ì˜ ì •ë ¬ ìˆœì„œë¥¼ ë‚˜íƒ€ëƒ„</p>\n<p>1-5. ì—°ë½ì²˜ì˜ ì—´ê±°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ íŒë‹¨. (ã…‡ã…–ì™¸ì‚¬í•­ ì²˜ë¦¬)<br>\n<em>do/try/catch /block</em>ì„ ì´ìš©í•´ ì˜¤ë¥˜ íŒë‹¨.</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">//1-5.</span></span><br><span class=\"line\">  <span class=\"comment\">// For each CNContact in your phone...</span></span><br><span class=\"line\">  <span class=\"keyword\">try</span> <span class=\"type\">CNContactStore</span>().enumerateContacts(with: fetchRequest) &#123; (contact, stop) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"comment\">//ì—°ë½ì²˜ë¥¼ ì •ë ¬</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// If this contact has a phone number, append to the array</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> contact.phoneNumbers.<span class=\"built_in\">count</span> &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">      contacts.append(contact)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<p>do ë‚˜ëŠ” tryí•˜ê² ë‹¤, CNContactStore()ì„ í†µí•´, enumerateContacts(ì—°ë½ì²˜ ê°€ì ¸ ì˜¤ê¸° ìš”ì²­ê³¼ ì¼ì¹˜í•˜ëŠ” ëª¨ë“  ì—°ë½ì²˜ì˜ ì—´ê±°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¶€ìš¸ ê°’ì„ ë°˜í™˜)ì— ì ‘ê·¼ ~ fetchRequest(ê²€ìƒ‰ ê¸°ì¤€ì„ ì§€ì •í•˜ëŠ” ì—°ë½ì²˜ ê°€ì ¸ ì˜¤ê¸° ìš”ì²­.<br>\n)ì„ ìš”ì²­í•˜ì—¬ (contact(ì„±ê³µ), stop(ì˜¤ë¥˜))ì‹œ ì— ëŒ€í•œ ì •ë³´ í´ë¡œì € ì´ìš©í•˜ì—¬ ì„±ê³µ ë° ì˜¤ë¥˜ì‚¬í•­ ì •ì˜.</p>\n<p>ë§Œì•½ ì„±ê³µì‹œ, contact.phoneNumbers.count &gt; 0 { ì´ë©´ contxts.append(contact)<br>\nê·¸ëƒ¥ ì •ë ¬í•œë‹¤ëŠ” ì†Œë¦¬â€¦</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> e <span class=\"keyword\">as</span> <span class=\"type\">NSError</span> &#123;</span><br><span class=\"line\">       <span class=\"built_in\">print</span>(e.localizedDescription)</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">     </span><br><span class=\"line\">     <span class=\"type\">DispatchQueue</span>.main.async(execute: &#123; () -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">       <span class=\"comment\">//ì™„ì„±ë˜ë©´ contacts ë°°ì—´ì„ ì œê³µ</span></span><br><span class=\"line\">       completionHandler(contacts)</span><br><span class=\"line\">       </span><br><span class=\"line\">     &#125;)</span><br><span class=\"line\">   &#125;)</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>ë§Œì•½ ì—ëŸ¬ë‚˜ë©´, e.localizedDescriptionì„ í”„ë¦°íŠ¸í•˜ê³ , ì–´ì”½í¬(ì‹œë¶„í• ë°©ì‹ - ë¹„ë™ê¸°) í†µí•´ completionHandler(ë¹„ë™ê¸° ì™„ë£Œì‹œì )ì— (contacts)ë°˜í™˜ (Voidë¥¼ ë°˜í™˜)í•˜ì—¬ ì˜¤ë¥˜ê°€ ë°˜í™˜ë¨.</p>\n<p>ì´ ë©”ì„œë“œëŠ” ì—´ê±°ê°€ ì™„ë£Œ ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê¸° ë•Œë¬¸ì—, ê²°ê³¼ê°€ ì—†ìœ¼ë©´ ë¸”ë¡ì´ í˜¸ì¶œë˜ì§€ ì•Šê³  ë©”ì„œë“œê°€ trueë¥¼ ë°˜í™˜í•œë‹¤.<br>\nëª¨ë“  ì—°ë½ì²˜ë¥¼ í•œ ë²ˆì— ë©”ëª¨ë¦¬ì— ë³´ê´€í•˜ì§€ ì•Šê³  ëª¨ë“  ì—°ë½ì²˜ë¥¼ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— ë¹„ìš©ì´ ë§ì´ ë“ ë‹¤.</p>\n<p>ì—°ë½ì²˜ ê°€ì ¸ ì˜¤ê¸° ìš”ì²­ê³¼ ì¼ì¹˜í•˜ëŠ” ëª¨ë“  ì—°ë½ì²˜ì˜ ì—´ê±°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ trueì´ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê±°ì§“</p>\n<p>íœ´â€¦ ë™ê¸°/ë¹„ë™ê¸°ë¥¼ ë‹¤ì‹œ í•œë²ˆ í›‘ì–´ë´ì•¼ê² ë‹¤â€¦<br>\n<a href=\"https://m.blog.naver.com/PostView.nhn?blogId=jdub7138&amp;logNo=220937372865&amp;proxyReferer=https:%2F%2Fwww.google.com%2F\" target=\"_blank\">ë™ê¸°/ë¹„ë™ê¸° ì°¸ê³ í•˜ê¸°</a></p>\n<p>ì…€ ë¶€ë¶„ì€ ê·¸ëƒ¥ ì½”ë“œë³´ë©´ ëŒ€ì¶© ë¬´ìŠ¨ ëœ»ì¸ì§€ ì•Œê²ƒì´ë¼ ìƒê°í•˜ê³  cellë¡œ ë„˜ì–´ê°€ì.</p>\n<h2 id=\"2.-testtableviewcell\">2. testTableViewCell<a title=\"#2.-testtableviewcell\" href=\"#2.-testtableviewcell\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> UIKit</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">testTableViewCell</span>: <span class=\"title\">UITableViewCell</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"keyword\">let</span> identifier = <span class=\"string\">\"testTableViewCell\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">let</span> personImage = <span class=\"type\">UIImageView</span>()</span><br><span class=\"line\">      <span class=\"keyword\">let</span> personName = <span class=\"type\">UILabel</span>()</span><br><span class=\"line\">      <span class=\"keyword\">let</span> conditionMassge = <span class=\"type\">UILabel</span>()</span><br><span class=\"line\">      <span class=\"keyword\">let</span> inPerson = <span class=\"type\">UIButton</span>()</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">//      let personAddButton = UIButton()</span></span><br><span class=\"line\">  </span><br><span class=\"line\">        <span class=\"keyword\">override</span> <span class=\"keyword\">init</span>(style: <span class=\"type\">UITableViewCell</span>.<span class=\"type\">CellStyle</span>, reuseIdentifier: <span class=\"type\">String?</span>) &#123;</span><br><span class=\"line\">          <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>(style: style, reuseIdentifier: reuseIdentifier)</span><br><span class=\"line\">          </span><br><span class=\"line\">          selectionStyle = .<span class=\"keyword\">none</span></span><br><span class=\"line\">          </span><br><span class=\"line\">          personImage.backgroundColor = .systemGray4</span><br><span class=\"line\">          personImage.image = <span class=\"type\">UIImage</span>(systemName: <span class=\"string\">\"person\"</span>)</span><br><span class=\"line\">          personImage.tintColor = .lightGray</span><br><span class=\"line\">          personImage.layer.cornerRadius = <span class=\"number\">15</span></span><br><span class=\"line\">          contentView.addSubview(personImage)</span><br><span class=\"line\">          </span><br><span class=\"line\">          personName.text = <span class=\"string\">\"ì´ë¦„\"</span></span><br><span class=\"line\">         <span class=\"comment\">// personName.font = UIFont.boldSystemFont(ofSize: 17)</span></span><br><span class=\"line\">          conditionMassge.font = <span class=\"type\">UIFont</span>(name: <span class=\"string\">\"PingFangHK-Medium\"</span>, size: <span class=\"number\">17</span>)</span><br><span class=\"line\">          contentView.addSubview(personName)</span><br><span class=\"line\">          </span><br><span class=\"line\">          conditionMassge.text = <span class=\"string\">\"ì¦ê±°ìš´ í•˜ë£¨~~ ë¹›ë‚˜ëŠ” ë¯¸ë˜ê°€ ë³´ì—¬ğŸ¶\"</span></span><br><span class=\"line\">          conditionMassge.font = <span class=\"type\">UIFont</span>(name: <span class=\"string\">\"PingFangHK-Thin\"</span>, size: <span class=\"number\">14</span>)</span><br><span class=\"line\">          conditionMassge.textColor = .gray</span><br><span class=\"line\">          contentView.addSubview(conditionMassge)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//  conditionCheck.text = \"21ë¶„ì „\"</span></span><br><span class=\"line\">          inPerson.setTitle(<span class=\"string\">\"+ ì´ˆëŒ€\"</span>, <span class=\"keyword\">for</span>: .normal)</span><br><span class=\"line\">          inPerson.titleLabel?.font = <span class=\"type\">UIFont</span>(name: <span class=\"string\">\"PingFangHK-Medium\"</span>, size: <span class=\"number\">12</span>)</span><br><span class=\"line\">          inPerson.setTitleColor(.black, <span class=\"keyword\">for</span>: .normal)</span><br><span class=\"line\">          inPerson.layer.borderColor = <span class=\"type\">UIColor</span>.black.cgColor</span><br><span class=\"line\">          inPerson.backgroundColor = .yellow</span><br><span class=\"line\">          inPerson.layer.borderWidth = <span class=\"number\">1</span></span><br><span class=\"line\">          inPerson.layer.cornerRadius = contentView.frame.width/<span class=\"number\">23</span></span><br><span class=\"line\">          contentView.addSubview(inPerson)</span><br><span class=\"line\">          </span><br><span class=\"line\">          setConstrain()</span><br><span class=\"line\">          </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">setConstrain</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        ë ˆì´ì•„ì›ƒì€ ìƒëµ..</span><br><span class=\"line\"></span><br><span class=\"line\">        ])</span><br><span class=\"line\">        </span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">        <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>?(coder aDecoder: <span class=\"type\">NSCoder</span>) &#123;</span><br><span class=\"line\">          <span class=\"built_in\">fatalError</span>(<span class=\"string\">\"init(coder:) has not been implemented\"</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ìœ„ì˜ vcê°€ ì—°ë½ì²˜ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” tablewViewì˜€ë‹¤ë©´, estTableViewCellì€<br>\nê·¸ì— ëŒ€í•œ ì…€ì´ë‹¤.</p>\n<p>í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë§Œë“ ê²ƒì´ë¼ì„œâ€¦ ë³€ìˆ˜ëª…ì´ ì¢€ í—·ê¹”ë¦´ ìˆ˜ ìˆëŠ”ë°</p>\n<p>conditionMassgeê°€ í°ë„˜ë²„ì— í•´ë‹¹ëœë‹¤. ì›ë˜ ìƒíƒœë©”ì„¸ì§€ ê°€ì ¸ì˜¤ëŠ” ê±¸ êµ¬í˜„í•  ê³„íšì´ì—ˆë˜ê±°ë¼â€¦ ë²ˆí˜¸ëŠ” ì‚¬ì‹¤ ì…€ì— í‘œí˜„ì•ˆë˜ì–´ë„ ë˜ì§€ë§Œ ëˆˆìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ ì—¬ê¸°ë‹¤ê°€ ë¿Œë ¸ë‹¤â€¦ã…‹ã…‹ã…‹â€¦</p>\n<p>ì•„ë˜ ì´ë¯¸ì§€ë¥¼ ë³´ë©´ ì´í•´ê°€ ë” ì‰¬ìš¸ê²ƒ ê°™ë‹¤. ğŸ™‚</p>\n<p><img src=\"/image/Contacts.png\" alt=\"\" class=\"Ï†cx\"></p>\n<p>ì´ëŸ¬ì¼€ ã…ã…â€¦</p>\n<p>ì–´ì¨Œë“  ë‚˜ëŠ” ì´ë¦„ê³¼ í°ë„˜ë²„ë§Œ ê°€ì ¸ì™”ì§€ë§Œ,<br>\ní•„ë“œë§Œ ì§€ì •í•´ì£¼ë©´ ì—°ë½ì²˜ìƒì— ì €ì¥ëœ ëª¨ë“  ë°ì´í„°(NCContact)ë¥¼ í†µí•´ ë©”ëª¨,ì´ë©”ì¼, ê¸°ë…ì¼?ë“±ë„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤ëŠ”ì  !!!</p>\n<p>ê·¸ë¦¬ê³  í°ë„˜ë²„ê°€ ë§Œì•½ 2ê°œ ì €ì¥ëœ ì •ë³´ë¼ë©´, ê°€ì¥ ìƒë‹¨ì— ìˆëŠ” ê°’ì„ ê°€ì ¸ì˜¨ë‹¤ëŠ” ì !</p>\n<p>ì•Œì•„ë‘ë©´ ì¢‹ì„ ë“¯ í•˜ë‹¤!</p>\n","prev":{"title":"[Swift]Textfield í„°ì¹˜ì‹œ í‚¤ë³´ë“œë‚´ë¦¬ê¸°, ë¦¬í„´ì‹œ ì»¤ì„œì´ë™(resignFirstResponder())","link":"2020/08/09/Swift-Textfield-á„á…¥á„á…µá„‰á…µ-á„á…µá„‡á…©á„ƒá…³á„‚á…¢á„…á…µá„€á…µ-á„…á…µá„á…¥á†«á„‰á…µ-á„á…¥á„‰á…¥á„‹á…µá„ƒá…©á†¼"},"next":{"title":"[Swift]Custom Tabbar","link":"2020/08/07/Swift-Custom-Tabbar"},"plink":"https://Qussk.github.io/2020/08/08/Swift-Contacts-á„‹á…§á†«á„…á…¡á†¨á„á…¥-á„Œá…¥á†¼á„‡á…©á„€á…¡á„Œá…§á„‹á…©á„€á…µ/","toc":[{"id":"1.-viewcontroller","title":"1. ViewController","index":"1"},{"id":"2.-testtableviewcell","title":"2. testTableViewCell","index":"2"}]}