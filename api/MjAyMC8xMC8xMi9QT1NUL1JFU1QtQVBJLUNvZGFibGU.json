{"title":"REST API - Codable","date":"2020-10-12T16:48:25.000Z","date_formatted":{"ll":"Oct 12, 2020","L":"10/12/2020","MM-DD":"10-12"},"link":"2020/10/12/POST/REST-API-Codable","tags":["Codable","Decod","REST API","Swift"],"categories":["post"],"updated":"2020-10-12T11:17:58.078Z","content":"<p>REST API활용해서 서버 따와야하는데 ,<br>\n알라모파이어 쓰랴, 코더블 쓰랴 그러면서 안되는 게 있으면 검색해보고 … (블로그는 뭐든 된다고만 하고… 되는 것만 올리니까 ;;) 이해 안되는 부분이 있었는데, 어쨋든 되니까 넘어가고;;<br>\n그런 과정이 있어서 정리했다. --;</p>\n<p>나를 가장 혼란스럽게 했던…</p>\n<p><strong>JSONSerialization…</strong>.<br>\n자꾸 되어야하는 게 안되서… 여러 방면으로 생각하다보니 jsonObject화 하지 않아서 안되는 건가 ?? 의문 스러워하며 이것고치고 저것고치고… 그런데 그 전엔 없어도 잘만 됐는데… 이상함… (반복)</p>\n<p>그리고 학원에서도 분명 JSONSerialization을 배우긴 했다. 근데 왜 사용하는 지도 모르고 그냥 달달… 외우고 코드보면서 썼던 것…</p>\n<p>🤔결국 이제야 알게된 것은, JSONSerialization은 swift3에서 지원했던 내용이고 5부터는 그냥 Codable하나면 오케이…😨👌</p>\n<p>나를 혼란스럽게 한 swift 3방식을 보자.</p>\n<h2 id=\"이전-swift-3-방식\">이전 Swift 3 방식<a title=\"#이전-swift-3-방식\" href=\"#이전-swift-3-방식\"></a></h2>\n<h3 id=\"json-data\"><em>JSON Data</em><a title=\"#json-data\" href=\"#json-data\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//\"https://api.letsbuildthatapp.com/jsondecodable/course\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    id = <span class=\"number\">1</span>;</span><br><span class=\"line\">    imageUrl = <span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/04782e30-d72a-4917-9d7a-c862226e0a93\"</span>;</span><br><span class=\"line\">    link = <span class=\"string\">\"https://www.letsbuildthatapp.com/course/instagram-firebase\"</span>;</span><br><span class=\"line\">    name = <span class=\"string\">\"Instagram Firebase\"</span>;</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span> = <span class=\"number\">49</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>이런 json형식의 데이터가 있다고 가정한다.</p>\n<h3 id=\"data-model\"><em>Data Model</em><a title=\"#data-model\" href=\"#data-model\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Course</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> link: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> imageUrl: <span class=\"type\">String</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>(json: [<span class=\"type\">String</span>: <span class=\"type\">Any</span>]) &#123;</span><br><span class=\"line\">        id = json[<span class=\"string\">\"id\"</span>] <span class=\"keyword\">as</span>? <span class=\"type\">Int</span> ?? -<span class=\"number\">1</span></span><br><span class=\"line\">        name = json[<span class=\"string\">\"name\"</span>] <span class=\"keyword\">as</span>? <span class=\"type\">String</span> ?? <span class=\"string\">\"\"</span></span><br><span class=\"line\">        link = json[<span class=\"string\">\"link\"</span>] <span class=\"keyword\">as</span>? <span class=\"type\">String</span> ?? <span class=\"string\">\"\"</span></span><br><span class=\"line\">        imageUrl = json[<span class=\"string\">\"imageUrl\"</span>] <span class=\"keyword\">as</span>? <span class=\"type\">String</span> ?? <span class=\"string\">\"\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//자동완성됨</span></span><br><span class=\"line\"><span class=\"comment\">//let myCourse = Course(id: &lt;#T##Int#&gt;, name: &lt;#T##String#&gt;, link: &lt;#T##String#&gt;, imageUrl: &lt;#T##String#&gt;)</span></span><br><span class=\"line\"><span class=\"comment\">//print(myCourse)</span></span><br></pre></td></tr></table></figure>\n<p>swift3에서는 반드시 init함수로 JSON데이터를 객체화 해야했다. 데이터를 사용하고 싶다면 데이터를 인스턴스화해서 사용하라!.<br>\n그리고 그것은 보통 딕셔너리타입일 것…</p>\n<p>아래 파싱하는 부분을 보자.</p>\n<h3 id=\"parsing\"><em>Parsing</em><a title=\"#parsing\" href=\"#parsing\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parsingFuntion</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> jsonUrlString = <span class=\"string\">\"https://api.letsbuildthatapp.com/jsondecodable/course\"</span></span><br><span class=\"line\">  <span class=\"comment\">//http://....\" 문자열을 변환해서 url구조체로 만든 다음 -&gt; url세션으로 처리한다.</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> url = <span class=\"type\">URL</span>(string: jsonUrlString) <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\">  <span class=\"comment\">//보통은 에러처리먼저</span></span><br><span class=\"line\">    <span class=\"comment\">//1.</span></span><br><span class=\"line\">    <span class=\"type\">URLSession</span>.shared.dataTask(with: url) &#123; (data, response, error) <span class=\"keyword\">in</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"데이터 다운로드 완료\"</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> data = data <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//        let dataAsString = String(data: data, encoding: .utf8)</span></span><br><span class=\"line\">        <span class=\"comment\">//        print(dataAsString)</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">//2.</span></span><br><span class=\"line\">            <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> json = <span class=\"keyword\">try</span> <span class=\"type\">JSONSerialization</span>.jsonObject(with: data, options: .mutableContainers) <span class=\"keyword\">as</span>? [<span class=\"type\">String</span>: <span class=\"type\">Any</span>] <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;<span class=\"comment\">//제이슨을 딕셔너리로</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">let</span> course = <span class=\"type\">Course</span>(json: json)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(course)</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> jsonErr &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">\"Error serializing json:\"</span>, jsonErr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;.resume()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">parsingFuntion() <span class=\"comment\">//호출</span></span><br></pre></td></tr></table></figure>\n<p>urlSting문자열을 변환해서 url구조체로 만든 다음  URLSession을 통해 shared.dataTask하고, 이후 data, response, error 를 정의하여 처리하는 과정은 현재와 동일한 방식이지만, 아래 try이후<br>\nJSONSerialization.jsonObject 부분이 다른 걸 볼 수 있다. 순서로 코드를 보자면,</p>\n<ol>\n<li>파싱을 통해서 json객체가 나오고 -&gt; 2.딕셔너리로 타입캐스팅을 한번 하고 -&gt; 3.그것을 토대로 객체(인스턴스)생성.(위에 init. 구조체이거나 클래스이거나) 그리고 그 4. 제이슨을 딕셔너리로 …</li>\n</ol>\n<p>이점을 참고하여 , 아래의 글 swift 5부터 Codable등장 이후 변경된 점을 보자.</p>\n<h2 id=\"swift-5-이상\">Swift 5 이상<a title=\"#swift-5-이상\" href=\"#swift-5-이상\"></a></h2>\n<h3 id=\"json-data-1\"><em>JSON Data</em><a title=\"#json-data-1\" href=\"#json-data-1\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//\"https://api.letsbuildthatapp.com/jsondecodable/course\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    id = <span class=\"number\">1</span>;</span><br><span class=\"line\">    imageUrl = <span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/04782e30-d72a-4917-9d7a-c862226e0a93\"</span>;</span><br><span class=\"line\">    link = <span class=\"string\">\"https://www.letsbuildthatapp.com/course/instagram-firebase\"</span>;</span><br><span class=\"line\">    name = <span class=\"string\">\"Instagram Firebase\"</span>;</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span> = <span class=\"number\">49</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>이러한 JOSN 형식의 데이터가 있다고 가정. (위와 동일)</p>\n<h3 id=\"datamodel\"><em>DataModel</em><a title=\"#datamodel\" href=\"#datamodel\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//구조체라서 컴파일러가 알아서 init을 만들어줬기때문에 생략가능. (멤버와이징이니셜라이저)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Course</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> link: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> imageUrl: <span class=\"type\">String</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Codable(decode, encode둘다 사용), Decodable(데이터 가져올때), encodable(데이터 넣을 때)</li>\n<li>class인 경우 init함수를 써야하지만 swift3처럼 딕셔너리화할 필요는 없다. 그냥 쓰면 됨!!</li>\n</ul>\n<h3 id=\"parsing-1\"><em>parsing</em><a title=\"#parsing-1\" href=\"#parsing-1\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parsingFuntion</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> jsonUrlString = <span class=\"string\">\"https://api.letsbuildthatapp.com/jsondecodable/course\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> url = <span class=\"type\">URL</span>(string: jsonUrlString) <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"type\">URLSession</span>.shared.dataTask(with: url) &#123; (data, response, error) <span class=\"keyword\">in</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"데이터 다운로드 완료\"</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> data = data <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//요부분.. </span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> course = <span class=\"keyword\">try</span> <span class=\"type\">JSONDecoder</span>().decode(<span class=\"type\">Course</span>.<span class=\"keyword\">self</span>, from: data) </span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(course.name)</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> jsonErr &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">\"Error serializing json:\"</span>, jsonErr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;.resume()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">parsingFuntion()</span><br></pre></td></tr></table></figure>\n<p>urlString을 URLSession을통해 변환하여 처리하는 것 동일.<br>\ndo 부터 swift3와 다르게, 제이슨 객체로 주는 것이 아니라, 1.제이슨 디코더로 만듦.  -&gt; 4.딕셔너리로 변환함.(끝…) swift3에서 나열했던 2~3단계를 줄임. 1과 4만 존재…<br>\n파싱은 -&gt; 바로 인스턴스 객체로 감(init)을 의미하게 됨.</p>\n<h3 id=\"[배열인-경우]\"><strong>[배열인 경우]</strong><a title=\"#[배열인-경우]\" href=\"#[배열인-경우]\"></a></h3>\n<h3 id=\"json-data-2\"><em>JSON Data</em><a title=\"#json-data-2\" href=\"#json-data-2\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//\"https://api.letsbuildthatapp.com/jsondecodable/courses\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[&#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">6</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"AppStore JSON APIs\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/course/AppStore-JSON-APIs\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/fd78be85-b845-4672-a316-7df0abe80812_medium\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">47</span>&#125;,</span><br><span class=\"line\"> &#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"Tinder Firestore Swipe and Match\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/course/Tinder-Firestore-Swipe-and-Match\"</span>,</span><br><span class=\"line\">   <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/bc5a4091-d2ea-44ab-b749-5f2ee5354c35_medium\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">47</span>&#125;,</span><br><span class=\"line\"> &#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"Instagram Firebase\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/course/instagram-firebase\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/04782e30-d72a-4917-9d7a-c862226e0a93\"</span>,<span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">49</span>&#125;,</span><br><span class=\"line\"> &#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"Podcasts Course\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/course/podcasts\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/32f98d9d-5b9b-4a22-a012-6b87fd7158c2_medium\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">39</span>&#125;,</span><br><span class=\"line\"> &#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"Intermediate Training Core Data\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/course/intermediate-training-core-data\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/0736fecb-5b88-483b-a83d-ca2a5a6d93f9_medium\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">32</span>&#125;,</span><br><span class=\"line\"> &#123;<span class=\"string\">\"id\"</span>:<span class=\"number\">4</span>,</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"Kindle Basic Training\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"link\"</span>:<span class=\"string\">\"https://www.letsbuildthatapp.com/basic-training\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"imageUrl\"</span>:<span class=\"string\">\"https://letsbuildthatapp-videos.s3-us-west-2.amazonaws.com/a6180731-c077-46e7-88d5-4900514e06cf_medium\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"number_of_lessons\"</span>:<span class=\"number\">19</span>&#125;]</span><br></pre></td></tr></table></figure>\n<p>이런식의 배열의 데이터가 주어진다면…</p>\n<h3 id=\"parsing-2\"><em>Parsing</em><a title=\"#parsing-2\" href=\"#parsing-2\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parsingArrays</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> jsonUrlString = <span class=\"string\">\"https://api.letsbuildthatapp.com/jsondecodable/courses\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> url = <span class=\"type\">URL</span>(string: jsonUrlString) <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"type\">URLSession</span>.shared.dataTask(with: url) &#123; (data, response, error) <span class=\"keyword\">in</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"데이터 다운로드 완료\"</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> data = data <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;        </span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">let</span> courses = <span class=\"keyword\">try</span> <span class=\"type\">JSONDecoder</span>().decode([<span class=\"type\">Course</span>].<span class=\"keyword\">self</span>, from: data) <span class=\"comment\">//배열의 경우</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(courses)</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> jsonErr &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">\"Error serializing json:\"</span>, jsonErr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;.resume()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">parsingArrays()</span><br></pre></td></tr></table></figure>\n<p>Course를 [Course]로 감싸주기만 하면 된당…</p>\n<h3 id=\"다른-예시\"><strong>다른 예시</strong><a title=\"#다른-예시\" href=\"#다른-예시\"></a></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">WebsiteDescription</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> description: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> courses: [<span class=\"type\">Course</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parsingDatas</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> jsonUrlString = <span class=\"string\">\"https://api.letsbuildthatapp.com/jsondecodable/website_description\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> url = <span class=\"type\">URL</span>(string: jsonUrlString) <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"type\">URLSession</span>.shared.dataTask(with: url) &#123; (data, response, error) <span class=\"keyword\">in</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> data = data <span class=\"keyword\">else</span> &#123; <span class=\"keyword\">return</span> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">let</span> websiteDescription = <span class=\"keyword\">try</span> <span class=\"type\">JSONDecoder</span>().decode(<span class=\"type\">WebsiteDescription</span>.<span class=\"keyword\">self</span>, from: data)</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(websiteDescription) <span class=\"comment\">//이것도 그냥 맞춰서 쓰면 됨.. 배열무서워하지 말기!!</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> <span class=\"keyword\">let</span> jsonErr &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">\"Error serializing json:\"</span>, jsonErr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;.resume()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">parsingDatas()</span><br></pre></td></tr></table></figure>\n","next":{"title":"Error Handling(에러핸들링) - throwing함수, do-catch try, Result","link":"2020/10/10/POST/Swift-throwing-함수"},"plink":"https://Qussk.github.io/2020/10/12/POST/REST-API-Codable/","toc":[{"id":"이전-swift-3-방식","title":"이전 Swift 3 방식","index":"1","children":[{"id":"json-data","title":"JSON Data","index":"1.1"},{"id":"data-model","title":"Data Model","index":"1.2"},{"id":"parsing","title":"Parsing","index":"1.3"}]},{"id":"swift-5-이상","title":"Swift 5 이상","index":"2","children":[{"id":"json-data-1","title":"JSON Data","index":"2.1"},{"id":"datamodel","title":"DataModel","index":"2.2"},{"id":"parsing-1","title":"parsing","index":"2.3"},{"id":"[배열인-경우]","title":"[배열인 경우]","index":"2.4"},{"id":"json-data-2","title":"JSON Data","index":"2.5"},{"id":"parsing-2","title":"Parsing","index":"2.6"},{"id":"다른-예시","title":"다른 예시","index":"2.7"}]}]}