{"title":"[Swift] CustomStringConvertible - 원하는 데이터만 커스텀하여 출력","date":"2020-10-17T16:42:13.000Z","date_formatted":{"ll":"Oct 17, 2020","L":"10/17/2020","MM-DD":"10-17"},"link":"2020/10/17/Swift-CustomStringConvertible-원하는-데이터만-커스텀하여-출력","tags":["CustomStringConvertible","Swift"],"categories":["ios"],"updated":"2020-10-17T09:43:29.733Z","content":"<h2 id=\"decoding으로-가져온-data\">decoding으로 가져온 data<a title=\"#decoding으로-가져온-data\" href=\"#decoding으로-가져온-data\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> Foundation</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Weather</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> main: <span class=\"type\">Main</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> sky: [<span class=\"type\">Sky</span>]</span><br><span class=\"line\">  <span class=\"keyword\">let</span> date: <span class=\"type\">Date</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Main</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> temp: <span class=\"type\">Double</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> temp_min: <span class=\"type\">Double</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> temp_max: <span class=\"type\">Double</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">//sampleData의 weather값과 동일</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Sky</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> id: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> main: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> description: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> icon: <span class=\"type\">String</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//MARK: - Decodable</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">Weather</span>: <span class=\"title\">Decodable</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">CodingKeys</span>: <span class=\"title\">String</span>, <span class=\"title\">CodingKey</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//sampleData에서 필요한 3가지 데이터 파싱</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> weather, main, dt</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">init</span>(from decoder: <span class=\"type\">Decoder</span>) <span class=\"keyword\">throws</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> container = <span class=\"keyword\">try</span> decoder.container(keyedBy: <span class=\"type\">CodingKeys</span>.<span class=\"keyword\">self</span>)</span><br><span class=\"line\">    sky = <span class=\"keyword\">try</span> container.decode([<span class=\"type\">Sky</span>].<span class=\"keyword\">self</span>, forKey: .weather)<span class=\"comment\">//weather라는 key이용해서 [Sky]라는 배열타입을 꺼내서 sky에 할당.</span></span><br><span class=\"line\">    main = <span class=\"keyword\">try</span> container.decode(<span class=\"type\">Main</span>.<span class=\"keyword\">self</span>, forKey: .main)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> timestamp = <span class=\"keyword\">try</span> container.decode(<span class=\"type\">TimeInterval</span>.<span class=\"keyword\">self</span>, forKey: .dt)</span><br><span class=\"line\">    date = <span class=\"type\">Date</span>(timeIntervalSince1970: timestamp)</span><br><span class=\"line\">    <span class=\"comment\">//date가 아닌 TimeInterval로 꺼내 온 후, dete에 할당.</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>decode한 데이터를 가져오게 되면 아래처럼 프린트가 된다.</p>\n<p><img src=\"/image/weather.png\" alt=\"\" class=\"φcx\"></p>\n<p>보통 decoding해서 받아오는 정보는 이런식으로 출력된다.</p>\n<p>하지만, 필요한 정보만 출력하여 보고 싶다면 !?<br>\n<s>형식을 바꿔보고 싶어!!</s><br>\nCustomStringConvertible을 이용하면 된다.</p>\n<h2 id=\"2.-customstringconvertible\">2. CustomStringConvertible<a title=\"#2.-customstringconvertible\" href=\"#2.-customstringconvertible\"></a></h2>\n<p>decode한 데이터를 extension하여 CustomStringConvertible로 처리!!<br>\nvar description: String { 을 fix하라고 컴파일오류로 알려줌.</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//내가 원하는 데이터만 보기 쉽게 구성</span></span><br><span class=\"line\"><span class=\"comment\">//MARK: -CustomStringConvertible</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">Weather</span> : <span class=\"title\">CustomStringConvertible</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> description: <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> formatter = <span class=\"type\">DateFormatter</span>()</span><br><span class=\"line\">    formatter.dateFormat = <span class=\"string\">\"MM.dd HH시\"</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> description = <span class=\"string\">\"[ \\(formatter.string(from: date)) ]\"</span></span><br><span class=\"line\">    description += <span class=\"string\">\" ☀️ \\(sky.first!.main) (\\(sky.first!.description)), \"</span></span><br><span class=\"line\">    <span class=\"comment\">//main이랑 description부분만 출력하고 온도만 따로</span></span><br><span class=\"line\">    description += <span class=\"string\">\" 🌡 \\(main.temp)º\"</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"\\n\"</span> + description</span><br><span class=\"line\">    <span class=\"comment\">//예시 [02.02 02시] ☀️ clouds(튼 구름),🌡 22.95º</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>만약 이런식으로 구성했다면…<br>\n아래처럼 출력하게 됨!!</p>\n<p><img src=\"/image/weather2.png\" alt=\"\" class=\"φcx\"></p>\n<p>완성!!</p>\n","next":{"title":"[git] git 사용정리","link":"2020/10/16/git-git-사용정리"},"plink":"https://Qussk.github.io/2020/10/17/Swift-CustomStringConvertible-원하는-데이터만-커스텀하여-출력/","toc":[{"id":"decoding으로-가져온-data","title":"decoding으로 가져온 data","index":"1"},{"id":"2.-customstringconvertible","title":"2. CustomStringConvertible","index":"2"}]}