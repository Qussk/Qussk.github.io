{"title":"[Swift]FireBase이용하여 faceBook로그인","date":"2020-08-11T16:58:51.000Z","date_formatted":{"ll":"Aug 11, 2020","L":"08/11/2020","MM-DD":"08-11"},"thumbnail":"/image/face.png","link":"2020/08/11/Swift-FireBase이용하여-faceBook로그인","tags":["FaceBook","FireBase","Swift","라이브러리"],"categories":["ios"],"updated":"2020-09-05T12:57:12.869Z","content":"<p>너무너무 힘들었던 facebook로그인…<br>\n모 블로그 보면서 하고 유튭봐도 최신게 거의 없어서… 이름도 너무 비슷하게 다르고 나오지도 않고…ㅠㅠㅠㅠㅠㅠ</p>\n<p>긴 설명은 하지 않고 필요한 것만 딱딱 쓰겠다.</p>\n<p>아, 일단 페이스북 개발자사이트 쪽으로 들어가서  APPID부터 받아야한다.</p>\n<p>이에 대한 내용은 구글링하면 금방 나오니, 나는 핵심만</p>\n<h1 id=\"pod\">pod<a title=\"#pod\" href=\"#pod\"></a></h1>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pod &#39;FBSDKLoginKit&#39;</span><br><span class=\"line\">pod &#39;FBSDKCoreKit&#39;</span><br></pre></td></tr></table></figure>\n<h1 id=\"info.plist\">info.plist<a title=\"#info.plist\" href=\"#info.plist\"></a></h1>\n<p><img src=\"image/face1.png\" alt=\"\" class=\"φcx\"></p>\n<p>페북에서 받은 AppID와 나의 앱이름을 넣어준다.</p>\n<p><img src=\"image/face2.png\" alt=\"\" class=\"φcx\"></p>\n<p>오픈소스로 접근하여 저것도 수동으로 넣어줘야한다. 페이스북에 대한것 모조리…<br>\n참고로 45 ~ 71까지가 맞음… ㅎㅎ</p>\n<h1 id=\"appdelegate\">AppDelegate<a title=\"#appdelegate\" href=\"#appdelegate\"></a></h1>\n<h2 id=\"import-할-것,,\">import 할 것,<a title=\"#import-할-것,,\" href=\"#import-할-것,,\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> FBSDKCoreKit</span><br></pre></td></tr></table></figure>\n<h2 id=\"didfinishlaunchingwithoptions\"><strong>didFinishLaunchingWithOptions</strong><a title=\"#didfinishlaunchingwithoptions\" href=\"#didfinishlaunchingwithoptions\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//1</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: <span class=\"keyword\">Any</span>]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"type\">FirebaseApp</span>.configure()</span><br><span class=\"line\">    </span><br><span class=\"line\">  <span class=\"comment\">// FacebookAuthProvider.credential(withAccessToken: AccessToken.current!.tokenString)</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"type\">ApplicationDelegate</span>.shared.application( application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"openurloptionskey\"><strong>OpenURLOptionsKey</strong><a title=\"#openurloptionskey\" href=\"#openurloptionskey\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//2</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">( <span class=\"number\">_</span> app: UIApplication, <span class=\"keyword\">open</span> url: URL, options: [UIApplication.OpenURLOptionsKey : <span class=\"keyword\">Any</span>] = [:] )</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> faceBook = <span class=\"type\">ApplicationDelegate</span>.shared.application(</span><br><span class=\"line\">  app,</span><br><span class=\"line\">  <span class=\"keyword\">open</span>: url,</span><br><span class=\"line\">  sourceApplication: options[<span class=\"type\">UIApplication</span>.<span class=\"type\">OpenURLOptionsKey</span>.sourceApplication] <span class=\"keyword\">as</span>? <span class=\"type\">String</span>, annotation: options[<span class=\"type\">UIApplication</span>.<span class=\"type\">OpenURLOptionsKey</span>.annotation])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">return</span> faceBook</span><br></pre></td></tr></table></figure>\n<h2 id=\"sourceapplication\"><strong>sourceApplication</strong><a title=\"#sourceapplication\" href=\"#sourceapplication\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//3</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, <span class=\"keyword\">open</span> url: URL, sourceApplication: String?, annotation: <span class=\"keyword\">Any</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">let</span> faceBook =  <span class=\"type\">ApplicationDelegate</span>.shared.application(application, <span class=\"keyword\">open</span>: url,sourceApplication: sourceApplication, annotation: annotation)</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">return</span> faceBook</span><br></pre></td></tr></table></figure>\n<p>막상적으니 별로 없네 😡 앱딜에서 엄청 헤맷다… 구글이랑 같이 구동되어야해서!!!.. 넘 헷갈렷어, 함수막 중복되고…(위 코드들에선 다 제거했지만,)</p>\n<h1 id=\"viewcontroller\">ViewController<a title=\"#viewcontroller\" href=\"#viewcontroller\"></a></h1>\n<ul>\n<li>페북로그인 버튼이 존재하는 콘트롤러여야 한다.</li>\n</ul>\n<h2 id=\"import\"><strong>import</strong><a title=\"#import\" href=\"#import\"></a></h2>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> FBSDKLoginKit</span><br><span class=\"line\"><span class=\"keyword\">import</span> FBSDKCoreKit</span><br></pre></td></tr></table></figure>\n<h2 id=\"button\"><strong>button</strong><a title=\"#button\" href=\"#button\"></a></h2>\n<ul>\n<li>버튼은 커스텀으로 했다.</li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> faceBookButton = <span class=\"type\">UIButton</span>()</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">faceBookButton.setBackgroundImage(<span class=\"type\">UIImage</span>(named: <span class=\"string\">\"ficon2\"</span>), <span class=\"keyword\">for</span>: .normal)</span><br><span class=\"line\">  faceBookButton.addTarget(<span class=\"keyword\">self</span>, action: #selector(faceBookLoginAction(<span class=\"number\">_</span> :)), <span class=\"keyword\">for</span>: .touchUpInside)</span><br><span class=\"line\">  view.addSubview(faceBookButton)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//페북로그인</span></span><br><span class=\"line\"><span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">faceBookLoginAction</span><span class=\"params\">(<span class=\"number\">_</span> sender: <span class=\"keyword\">Any</span>)</span></span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">let</span> loginManager = <span class=\"type\">LoginManager</span>()</span><br><span class=\"line\">  <span class=\"keyword\">if</span> <span class=\"type\">AccessToken</span>.current != <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">    loginManager.logOut()</span><br><span class=\"line\">    updateButton(isLoggedIn: <span class=\"literal\">false</span>)</span><br><span class=\"line\">  &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    loginManager.logIn(permissions: [], from: <span class=\"keyword\">self</span>)&#123;[<span class=\"keyword\">weak</span> <span class=\"keyword\">self</span>] (result, err)<span class=\"keyword\">in</span></span><br><span class=\"line\">      <span class=\"comment\">//check 에러</span></span><br><span class=\"line\">      <span class=\"keyword\">guard</span> err == <span class=\"literal\">nil</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(err?.localizedDescription)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">//cancel 체크</span></span><br><span class=\"line\">      <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> result = result, !result.isCancelled <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"User cancelled login\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      </span><br><span class=\"line\">      <span class=\"comment\">//신경안써두됨</span></span><br><span class=\"line\">      <span class=\"keyword\">self</span>?.updateButton(isLoggedIn: <span class=\"literal\">true</span>)</span><br><span class=\"line\">      </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>하여튼 끝나고 페북버튼 누르게 되면</p>\n<p><img src=\"image/face3.png\" alt=\"\" class=\"φcx\"></p>\n<p>페북으로 연결되고 로그인하고… 그 페이스북에서 제공하는 테스트 계정으로 가는게 속편할 것 같지만…</p>\n<p>마무리…</p>\n","prev":{"title":"[Swift]UITest를 진행해 보자!","link":"2020/08/12/Swift-UITest-진행"},"next":{"title":"[Swift] FierBase 로그인/로그아웃","link":"2020/08/11/Swift-FierBase-로그인-로그아웃"},"plink":"https://Qussk.github.io/2020/08/11/Swift-FireBase이용하여-faceBook로그인/","toc":[{"id":"pod","title":"pod","index":"1"},{"id":"info.plist","title":"info.plist","index":"2"},{"id":"appdelegate","title":"AppDelegate","index":"3","children":[{"id":"import-할-것,,","title":"import 할 것,","index":"3.1"},{"id":"didfinishlaunchingwithoptions","title":"didFinishLaunchingWithOptions","index":"3.2"},{"id":"openurloptionskey","title":"OpenURLOptionsKey","index":"3.3"},{"id":"sourceapplication","title":"sourceApplication","index":"3.4"}]},{"id":"viewcontroller","title":"ViewController","index":"4","children":[{"id":"import","title":"import","index":"4.1"},{"id":"button","title":"button","index":"4.2"}]}]}